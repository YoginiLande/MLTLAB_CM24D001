<!DOCTYPE html>
<html>
<head>
<title>CNN MNIST Training</title>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
</head>

<body>
<h2>CNN Training </h2>
<button onclick="train()">Train CNN</button>
<pre id="log"></pre>

<script>
function log(msg){
  document.getElementById("log").textContent += msg + "\n";
}

async function train(){

  // small fake MNIST-like dataset (lightweight demo)
  const xs = tf.randomNormal([2000,28,28,1]);
  const ys = tf.oneHot(tf.randomUniform([2000],0,10,'int32'),10);

  const model = tf.sequential({
    layers:[
      tf.layers.conv2d({inputShape:[28,28,1],filters:8,kernelSize:3,activation:'relu'}),
      tf.layers.maxPooling2d({poolSize:2}),
      tf.layers.flatten(),
      tf.layers.dense({units:32,activation:'relu'}),
      tf.layers.dense({units:10,activation:'softmax'})
    ]
  });

  model.compile({
    optimizer:'adam',
    loss:'categoricalCrossentropy',
    metrics:['accuracy']
  });

  await model.fit(xs,ys,{
    epochs:5,
    callbacks:{
      onEpochEnd:(e,l)=>log(`Epoch ${e+1} accuracy: ${l.acc.toFixed(3)}`)
    }
  });

  log("Training finished âœ…");
}
</script>
</body>
</html>
