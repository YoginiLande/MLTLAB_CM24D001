<!DOCTYPE html>
<html>
<head>
  <title>Linear Regression</title>

  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
</head>
<body>

<h3>Linear Regression with Synthetic Data</h3>

<script>
  // Training data
  const xTrain = tf.tensor2d([1,2,3,4,5], [5,1]);
  const yTrain = tf.tensor2d([3,5,7,9,11], [5,1]);

  // Model
  const model = tf.sequential();
  model.add(tf.layers.dense({ units: 1, inputShape: [1] }));

  model.compile({
    optimizer: tf.train.sgd(0.01),
    loss: 'meanSquaredError'
  });

  async function run() {
    // Train
    await model.fit(xTrain, yTrain, { epochs: 200 });

    // Prediction (console)
    const pred = model.predict(tf.tensor2d([6], [1,1]));
    pred.print();   // â‰ˆ 13

    // Actual points
    const actual = [
      {x:1, y:3},
      {x:2, y:5},
      {x:3, y:7},
      {x:4, y:9},
      {x:5, y:11}
    ];

    // Predicted line
    const xs = [1,2,3,4,5,6];
    const predicted = xs.map(x => ({
      x: x,
      y: model.predict(tf.tensor2d([x],[1,1])).dataSync()[0]
    }));

    // Draw graph
    tfvis.render.scatterplot(
      { name: 'Linear Regression Graph' },
      {
        values: [actual, predicted],
        series: ['Actual Data', 'Regression Line']
      },
      {
        xLabel: 'X',
        yLabel: 'Y',
        height: 300
      }
    );
  }

  run();
</script>

</body>
</html>
